В MySQL существует множество встроенных функций и операторов для вычисления дат и времени, которые позволяют выполнять различные операции, такие как добавление или вычитание временных интервалов, определение разницы между двумя датами, извлечение отдельных частей даты (например, год, месяц, день), и многое другое. Давайте рассмотрим основные методы работы с датами и временем в MySQL.

### 1. **Добавление и вычитание интервалов**

#### **DATE_ADD() и DATE_SUB()**

- **`DATE_ADD()`** используется для добавления интервала к дате или времени.
- **`DATE_SUB()`** используется для вычитания интервала из даты или времени.

**Синтаксис**:
```sql
DATE_ADD(date, INTERVAL expr unit)
DATE_SUB(date, INTERVAL expr unit)
```

- `date`: Начальная дата или время.
- `expr`: Значение интервала, которое нужно добавить или вычесть.
- `unit`: Единица измерения интервала, такая как `DAY`, `MONTH`, `YEAR`, `HOUR`, `MINUTE`, `SECOND`, и т.д.

![[Table 11.2 Temporal Interval Expression and Unit Arguments.png]]

**Примеры**:

1. Добавление 10 дней к текущей дате:
   ```sql
   SELECT DATE_ADD(NOW(), INTERVAL 10 DAY) AS new_date;
   ```
   **Результат**: Если сегодня 10 августа 2024 года, результат будет `2024-08-20`.

2. Вычитание 2 месяцев из указанной даты:
   ```sql
   SELECT DATE_SUB('2024-08-10', INTERVAL 2 MONTH) AS new_date;
   ```
   **Результат**: `2024-06-10`.

### 2. **Разница между двумя датами**

#### **DATEDIFF()**

Функция **`DATEDIFF()`** используется для вычисления разницы между двумя датами в днях.

**Синтаксис**:
```sql
DATEDIFF(date1, date2)
```

- `date1`, `date2`: Даты для сравнения. Функция возвращает количество дней между `date1` и `date2`.

**Примеры**:

1. Разница между двумя датами:
   ```sql
   SELECT DATEDIFF('2024-08-10', '2024-01-01') AS days_difference;
   ```
   **Результат**: `222` дня.

### 3. **Извлечение частей даты и времени**

#### **YEAR(), MONTH(), DAY(), HOUR(), MINUTE(), SECOND()**

Эти функции используются для извлечения отдельных компонентов даты и времени.

**Синтаксис**:
```sql
YEAR (date)
MONTH(date)
DAY(date)
HOUR(time)
MINUTE(time)
SECOND(time)
```

**Примеры**:

1. Извлечение года, месяца и дня из даты:
   ```sql
   SELECT YEAR('2024-08-10') AS year, MONTH('2024-08-10') AS month, DAY('2024-08-10') AS day;
   ```
   **Результат**: `2024`, `8`, `10`.

2. Извлечение часов, минут и секунд из времени:
   ```sql
   SELECT HOUR('15:30:45') AS hour, MINUTE('15:30:45') AS minute, SECOND('15:30:45') AS second;
   ```
   **Результат**: `15`, `30`, `45`.

### 4. **Операции с датами и временем**

#### **TIMESTAMPDIFF() и TIMESTAMPADD()**

- **`TIMESTAMPDIFF()`** вычисляет разницу между двумя временными метками в указанных единицах.
- **`TIMESTAMPADD()`** добавляет указанный интервал к временной метке.

**Синтаксис**:
```sql
TIMESTAMPDIFF(unit, datetime_expr1, datetime_expr2)
TIMESTAMPADD(unit, interval_expr, datetime_expr)
```

- `unit`: Единица измерения интервала (например, `SECOND`, `MINUTE`, `HOUR`, `DAY`, `MONTH`, `YEAR`).
- `datetime_expr1`, `datetime_expr2`: Временные метки для сравнения.
- `interval_expr`: Интервал, который нужно добавить.

**Примеры**:

1. Разница в часах между двумя временными метками:
   ```sql
   SELECT TIMESTAMPDIFF(HOUR, '2024-08-10 12:00:00', '2024-08-10 18:00:00') AS hours_difference;
   ```
   **Результат**: `6` часов.

2. Добавление 30 минут к указанной временной метке:
   ```sql
   SELECT TIMESTAMPADD(MINUTE, 30, '2024-08-10 12:00:00') AS new_time;
   ```
   **Результат**: `2024-08-10 12:30:00`.

### 5. **Форматирование дат и времени**

#### **DATE_FORMAT()**

Функция **`DATE_FORMAT()`** используется для форматирования даты и времени в заданный формат.

**Синтаксис**:
```sql
DATE_FORMAT(date, format)
```

**Примеры**:

1. Форматирование даты в формате `DD/MM/YYYY`:
   ```sql
   SELECT DATE_FORMAT(NOW(), '%d/%m/%Y') AS formatted_date;
   ```
   **Результат**: `10/08/2024`.

### 6. **Текущая дата и время**

#### **NOW(), CURDATE(), CURTIME()**

- **`NOW()`** возвращает текущую дату и время.
- **`CURDATE()`** возвращает текущую дату.
- **`CURTIME()`** возвращает текущее время.

**Примеры**:

1. Получение текущей даты и времени:
   ```sql
   SELECT NOW() AS current_datetime;
   ```
   **Результат**: `2024-08-10 15:30:45`.

2. Получение текущей даты:
   ```sql
   SELECT CURDATE() AS current_date;
   ```
   **Результат**: `2024-08-10`.

3. Получение текущего времени:
   ```sql
   SELECT CURTIME() AS current_time;
   ```
   **Результат**: `15:30:45`.

### 7. **Преобразование строк в даты и времени**

#### **STR_TO_DATE()**

Функция **`STR_TO_DATE()`** используется для преобразования строки в дату или время на основе указанного формата.

**Синтаксис**:
```sql
STR_TO_DATE(string, format)
```

**Примеры**:

1. Преобразование строки в дату:
   ```sql
   SELECT STR_TO_DATE('10/08/2024', '%d/%m/%Y') AS date;
   ```
   **Результат**: `2024-08-10`.

Эти функции и методы позволяют эффективно работать с датами и временем в MySQL, предоставляя широкий спектр возможностей для вычислений и форматирования.